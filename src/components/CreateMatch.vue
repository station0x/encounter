<template>
    <div class="section onboarding">
        <div class="deployment-wrapper">
            <!-- <div class="polygon-container">
                <img class="child-img" src="https://res.cloudinary.com/station0x/image/upload/v1644878088/encouter/home/custom-mask-group_oedabd.png">
            </div> -->
            <svg height="600" viewBox="0 0 398 435" fill="none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                <g id="Deployment center">
                <text id="Deployment center_2" fill="white" xml:space="preserve" style="white-space: pre" font-family="Anson" font-size="22" letter-spacing="0em"><tspan x="115.214" y="15.844">DEPLOYMENT CENTER</tspan></text>
                <g id="casual-group">
                <g id="img-custom">
                <path id="Vector" d="M188.156 408.215V65H25.842L7 81.2819V426.074H167.219L188.156 408.215Z" fill="url(#pattern-custom)"/>
                <path id="Vector_2" d="M188.156 408.215V65H25.842L7 81.2819V426.074H167.219L188.156 408.215Z" fill="url(#paint0_radial_407_1287)"/>
                <g id="Vector_3">
                <path d="M188.156 408.215V65H25.842L7 81.2819V426.074H167.219L188.156 408.215Z" fill="#0A1325" style="mix-blend-mode:color"/>
                </g>
                </g>
                <path id="custom-vector" d="M194.286 413.418V58H23.2257L11.6129 67.3921L0 76.7842V434.02H168.84L194.286 413.418Z" stroke="#525252" stroke-miterlimit="10"/>
                <text id="custom" fill="white" xml:space="preserve" style="white-space: pre" font-family="Anson" font-size="24" letter-spacing="0em"><tspan x="23" y="258.148">CUSTOM</tspan></text>
                <text id="Challenge your friend in a private unranked match. Custom matches are good for practicing before joining ranked matchmaking." fill="white" xml:space="preserve" style="white-space: pre" font-family="Roboto" font-size="11" letter-spacing="0em"><tspan x="23" y="283.26">Challenge your friend in a </tspan><tspan x="23" y="296.26">private unranked match. </tspan><tspan x="23" y="309.26">Custom matches are good for </tspan><tspan x="23" y="322.26">practicing before joining </tspan><tspan x="23" y="335.26">ranked matchmaking.</tspan></text>
                <g id="create-btn-group">
                <g id="create-btn">
                <path id="create-rect" d="M66.25 375.25L172.75 375.25L172.75 405.566L167.768 410.75L73.1035 410.75L66.25 403.896L66.25 375.25Z" fill="url(#paint1_linear_407_1287)" stroke="#FBC115" stroke-width="0.5"/>
                </g>
                <text id="create" fill="#FBC115" xml:space="preserve" style="white-space: pre" font-family="Anson" font-size="18" letter-spacing="0em"><tspan x="97.0342" y="395.736">CREATE</tspan></text>
                </g>
                </g>
                <g id="Ranked-group">
                <path id="Vector_4" d="M397.286 78.6013V434.02H226.226L203 415.236V58H371.84L397.286 78.6013Z" stroke="#525252" stroke-miterlimit="10"/>
                <g id="img-ranked">
                <path id="Vector_5" d="M209 409.145V66H371.174L390 82.2785V427H229.919L209 409.145Z" fill="url(#pattern-ranked)"/>
                <path id="Vector_6" d="M209 409.145V66H371.174L390 82.2785V427H229.919L209 409.145Z" fill="url(#paint2_radial_407_1287)"/>
                <g id="Vector_7">
                <path d="M209 409.145V66H371.174L390 82.2785V427H229.919L209 409.145Z" fill="#210907" style="mix-blend-mode:color"/>
                </g>
                </g>
                <text id="Ranked / p2e" fill="white" xml:space="preserve" style="white-space: pre" font-family="Anson" font-size="24" letter-spacing="0em"><tspan x="224.634" y="258.148">RANKED / P2E</tspan></text>
                <text id="Assert your global dominance on the ranked leaderboard. Destroy enemy fleets and earn loot. You will be matched with enemy fleet captains based on your Elo." fill="white" xml:space="preserve" style="white-space: pre" font-family="Roboto" font-size="11" letter-spacing="0em"><tspan x="225" y="283.26">Assert your global dominance </tspan><tspan x="225" y="296.26">on the ranked leaderboard. </tspan><tspan x="225" y="309.26">Destroy enemy fleets and earn </tspan><tspan x="225" y="322.26">loot. You will be matched with </tspan><tspan x="225" y="335.26">enemy fleet captains based on </tspan><tspan x="225" y="348.26">your Elo. </tspan></text>
                <g id="find-match">
                <g id="findy">
                <path id="Rectangle 5" d="M271.25 375.25L376.75 375.25L376.75 405.566L371.768 410.75L278.104 410.75L271.25 403.896L271.25 375.25Z" fill="url(#paint3_linear_407_1287)" stroke="#FBC115" stroke-width="0.5"/>
                </g>
                <text id="FIND match" fill="#FBC115" xml:space="preserve" style="white-space: pre" font-family="Anson" font-size="18" letter-spacing="0em"><tspan x="287.262" y="395.736">FIND MATCH</tspan></text>
                </g>
                </g>
                </g>
                <defs>
                <pattern id="pattern-custom" patternContentUnits="objectBoundingBox" width="1" height="1">
                <use xlink:href="#image0_407_1287" transform="translate(-0.830994) scale(0.00332749 0.00166945)"/>
                </pattern>
                <pattern id="pattern-ranked" patternContentUnits="objectBoundingBox" width="1" height="1">
                <use xlink:href="#image1_407_1287" transform="translate(-1.08836) scale(0.00332967 0.00166945)"/>
                </pattern>
                <radialGradient id="paint0_radial_407_1287" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(97.578 245.537) rotate(90) scale(180.537 186.312)">
                <stop stop-opacity="0.2"/>
                <stop offset="1"/>
                </radialGradient>
                <linearGradient id="paint1_linear_407_1287" x1="119.5" y1="411" x2="119.5" y2="375" gradientUnits="userSpaceOnUse">
                <stop stop-color="#FBC115" stop-opacity="0"/>
                <stop offset="1" stop-color="#FBC115" stop-opacity="0.12"/>
                </linearGradient>
                <radialGradient id="paint2_radial_407_1287" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(299.5 246.5) rotate(90) scale(180.5 186.152)">
                <stop stop-opacity="0.2"/>
                <stop offset="1"/>
                </radialGradient>
                <linearGradient id="paint3_linear_407_1287" x1="323.5" y1="411" x2="323.5" y2="375" gradientUnits="userSpaceOnUse">
                <stop stop-color="#FBC115" stop-opacity="0"/>
                <stop offset="1" stop-color="#FBC115" stop-opacity="0.12"/>
                </linearGradient>
                <image id="image0_407_1287" data-name="custome-game.png" width="800" height="599" href="https://res.cloudinary.com/station0x/image/upload/v1644887359/encouter/home/custome-game_rectgq.png"/>
                <image id="image1_407_1287" data-name="ranked.png" width="800" height="599" href="https://res.cloudinary.com/station0x/image/upload/v1644887365/encouter/home/ranked_m1lhd5.png"/>
                </defs>
            </svg>
        </div>
    </div>
</template>

<script>
import GameGuide from '@/components/GameGuide.vue'
import axios from 'axios'
export default {
    data() {
        return {
            invitationLink: undefined,
            linkPrefix: '',
            createMatchLoader: false,
            findingMatchLoader: false,
            checkMatchLoader: true
        }
    },
    methods: {
        async createMatch() {
            this.createMatchLoader = true
            try {
                const res = await axios.get('/api/match/createMatch', {
                    params:{
                        signature:this.$store.state.signature
                    }
                })
                this.linkPrefix = window.location.host.split(':')[0] === 'localhost' ? 'http://' : 'https://'
                this.invitationLink = window.location.host + '/play/' + res.data.inviteLink
            } finally {
                this.createMatchLoader = false
            }
        },
        openGameGuideModal() {
            this.$buefy.modal.open({
                component: GameGuide
            })
        },
        async triggerMatchmaking() { 
            if(this.findingMatchLoader) {
                try {
                    this.findingMatchLoader = false
                    const res = await axios.get('/api/matchmaker/leaveMatchmaking', {
                        params:{
                            signature:this.$store.state.signature
                        }
                    })
                } finally {
                    this.createMatchLoader = false
                }
            } else {
                this.findingMatchLoader = true
                try {
                    const res = await axios.get('/api/matchmaker/joinMatchmaking', {
                        params:{
                            signature:this.$store.state.signature
                        }
                    })

                } finally {
                    this.createMatchLoader = false
                }
            }
        },
        async checkMatchmaking() {
            try {
                const res = await axios.get('/api/matchmaker/checkMatchmaking', {
                    params:{
                        signature:this.$store.state.signature
                    }
                })
                if(res.data.enqueued) this.findingMatchLoader = true
            } finally {
                this.checkMatchLoader = false
            }
        }
    },
    created() {
        this.checkMatchmaking()
    }
}
</script>


<style scoped>
.primary-btn {
    background: #F88C09 !important;
    color: black;
    border: none;
    width: 230px;
    height: 60px;
    margin: 15px;
    padding: 15px;
    font-size: 19px;
    font-weight: 500;
    transition: 250ms ease-in-out;
}
.primary-btn:hover {
    background: #f39a2d;
}
.secondary-btn {
    background: rgba(248, 140, 9, 0.1);
    border: 1px solid #F88C09;
    color: #F88C09;
    width: 230px;
    height: 60px;
    margin: 15px;
    padding: 15px;
    font-size: 19px;
    font-weight: 500;
    transition: 250ms ease-in-out;
}
.secondary-btn:hover {
    color: black;
    background: #F88C09;
    border: #F88C09;
}
.deployment-wrapper {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
    -ms-transform: translateX(-50%) translateY(-50%);
    -webkit-transform: translate(-50%,-50%);
    margin-top: 30px;
}
/* .polygon-container {
    clip-path: polygon(10% 0, 100% 0, 100% 95%, 90% 100%, 0 100%, 0 5%);
    height: 375px;
    width: 195px;
    background: transparent;
    padding: 10px;
    background: red;
} */
.polygon-container {
    display: inline-block;
    position: relative;
    height: 375px;
    width: 195px;
    background: rgba(82, 82, 82, 0.6);
    box-sizing: border-box;
    -webkit-clip-path: polygon(10% 0, 100% 0, 100% 95%, 90% 100%, 0 100%, 0 5%);
    clip-path: polygon(10% 0, 100% 0, 100% 95%, 90% 100%, 0 100%, 0 5%);
}
.polygon-container .child-img {
    position: absolute;
    top: 1px; /* equal to border thickness */
    left: 1px; /* equal to border thickness */
    height: 373px; /* container height - (border thickness * 2) */
    width: 193px; /* container height - (border thickness * 2) */
    -webkit-clip-path: polygon(10% 0, 100% 0, 100% 95%, 90% 100%, 0 100%, 0 5%);
    clip-path: polygon(10% 0, 100% 0, 100% 95%, 90% 100%, 0 100%, 0 5%);
}
</style>